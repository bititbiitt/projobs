{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ILT/projobs/src/app/api/post-job/parse-doc/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport mammoth from 'mammoth';\r\nimport pdfParse from 'pdf-parse';\r\n\r\nexport async function POST(request: Request) {\r\n  try {\r\n    const body = await request.json();\r\n    const { name, mime, data } = body as { name: string; mime: string; data: string };\r\n    const b = Buffer.from(data, 'base64');\r\n    const lower = name.toLowerCase();\r\n\r\n    if (lower.endsWith('.docx') || mime === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document') {\r\n      const result = await mammoth.convertToHtml({ buffer: b });\r\n      return NextResponse.json({ ok: true, html: result.value, text: stripHtml(result.value) });\r\n    }\r\n\r\n    if (lower.endsWith('.pdf') || mime === 'application/pdf') {\r\n      const pdf = await pdfParse(b as any);\r\n      return NextResponse.json({ ok: true, text: pdf.text });\r\n    }\r\n\r\n    // fallback: try to decode as utf8 text\r\n    return NextResponse.json({ ok: true, text: b.toString('utf8') });\r\n  } catch (err) {\r\n    return NextResponse.json({ ok: false, error: String(err) }, { status: 500 });\r\n  }\r\n}\r\n\r\nfunction stripHtml(html: string) {\r\n  return html.replace(/<[^>]+>/g, ' ').replace(/\\s+/g, ' ').trim();\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG;QAC7B,MAAM,IAAI,OAAO,IAAI,CAAC,MAAM;QAC5B,MAAM,QAAQ,KAAK,WAAW;QAE9B,IAAI,MAAM,QAAQ,CAAC,YAAY,SAAS,2EAA2E;YACjH,MAAM,SAAS,MAAM,+JAAO,CAAC,aAAa,CAAC;gBAAE,QAAQ;YAAE;YACvD,OAAO,2JAAY,CAAC,IAAI,CAAC;gBAAE,IAAI;gBAAM,MAAM,OAAO,KAAK;gBAAE,MAAM,UAAU,OAAO,KAAK;YAAE;QACzF;QAEA,IAAI,MAAM,QAAQ,CAAC,WAAW,SAAS,mBAAmB;YACxD,MAAM,MAAM,MAAM,IAAA,6JAAQ,EAAC;YAC3B,OAAO,2JAAY,CAAC,IAAI,CAAC;gBAAE,IAAI;gBAAM,MAAM,IAAI,IAAI;YAAC;QACtD;QAEA,uCAAuC;QACvC,OAAO,2JAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM,MAAM,EAAE,QAAQ,CAAC;QAAQ;IAChE,EAAE,OAAO,KAAK;QACZ,OAAO,2JAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAO,OAAO,OAAO;QAAK,GAAG;YAAE,QAAQ;QAAI;IAC5E;AACF;AAEA,SAAS,UAAU,IAAY;IAC7B,OAAO,KAAK,OAAO,CAAC,YAAY,KAAK,OAAO,CAAC,QAAQ,KAAK,IAAI;AAChE"}}]
}