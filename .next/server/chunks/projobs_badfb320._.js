module.exports=[93131,e=>e.a(async(t,a)=>{try{var n=e.i(65731),o=e.i(33863),r=t([o]);async function i(e){try{let{searchParams:t}=new URL(e.url),a=t.get("q")||"",r=t.get("location")||"";t.get("radius");let i=e=>t.getAll(e).map(e=>e.trim()).filter(Boolean),l=i("category"),s=i("jobFunction"),d=i("jobType"),u=i("jobLevel"),c=i("salary"),p=i("workSite");i("dateRange");let h=t.get("dateRange")||"",g=Math.max(1,Number(t.get("page")||"1")),m=Math.max(1,Number(t.get("pageSize")||20)),R=[];a&&R.push({OR:[{title:{startsWith:a,mode:"insensitive"}},{job_function:{name:{startsWith:a,mode:"insensitive"}}},{job_category:{name:{startsWith:a,mode:"insensitive"}}},{organization:{startsWith:a,mode:"insensitive"}},{job_detail:{description:{contains:a,mode:"insensitive"}}}]}),r&&R.push({location:{contains:r,mode:"insensitive"}}),l.length&&R.push({jobCategory:{slug:{in:l}}}),s.length&&R.push({jobFunction:{slug:{in:s}}}),d.length&&R.push({type:{in:d}}),u.length&&R.push({level:{in:u}}),p.length&&R.push({workspace:{in:p}});let b={"0-30":["0","30"],"31-60":["31","60"],"61-100":["61","100"],"101-150":["101","150"],"151-200":["151","200"],"201-250":["201","250"],"251-300":["251","300"],"301-350":["301","350"],"350plus":["351"]},_=c.find(e=>"highest"===e||"lowest"===e)||"",f=c.filter(e=>b[e]);if(f.length){let e=f.map(e=>{let t=b[e],a=parseInt(t[0],10),n=t.length>1?parseInt(t[1],10):null,o=n?1e3*n:null,r={AND:[{maxPay:{gte:1e3*a}}]};return null!==o&&r.AND.push({minPay:{lte:o}}),r});R.push({OR:e})}let y=R.length?{AND:R}:{},v=[{created_at:"desc"}];"oldest"===h?v=[{createdAt:"asc"}]:"highest"===_?v=[{salary_range:"desc"},{created_at:"desc"}]:"lowest"===_&&(v=[{salary_range:"asc"},{created_at:"desc"}]);let w=[],E={...y},C=await o.db.job.count({where:E}),j=(g-1)*m,x=[];if(j<w.length){let e=[].slice(j,j+m);x=x.concat(e)}if(x.length<m){let e=m-x.length,t=Math.max(0,j-w.length),a=await o.db.job.findMany({where:E,skip:t,take:e,orderBy:v,select:{id:!0,title:!0,metadata:!0,is_featured:!0,created_at:!0}});x=x.concat(a)}let A=x.map(e=>({id:e.id,title:e.title||e.job_detail?.job_title||null,company:null,organization:null,location:e.job_location?.[0]?.address||null,zipCode:e.job_location?.[0]?.zip_geo||null,latitude:null,longitude:null,salaryRange:null,minPay:e.job_detail?.min_pay?Number(e.job_detail.min_pay):null,maxPay:e.job_detail?.max_pay?Number(e.job_detail.max_pay):null,type:null,level:null,workspace:null,featured:void 0!==e.is_featured?!!e.is_featured:!!e.metadata&&!!e.metadata.featured,slug:null,description:e.job_detail?.description||null,createdAt:e.created_at?e.created_at.toISOString():null,jobCategory:e.job_category_selection?.[0]?.job_category?{name:e.job_category_selection[0].job_category.name}:null,jobFunction:e.job_function_selection?.[0]?.job_function?{name:e.job_function_selection[0].job_function.name}:null,applyUrl:`/jobs/${e.id}`}));try{let e=new Set(A.map(e=>e.zipCode).filter(Boolean)),t=Array.from(e);if(t.length>0){let e=t.map(e=>`'${String(e).replace(/'/g,"''")}'`).join(","),a=await o.db.$queryRawUnsafe(`SELECT zip_code, latitude, longitude FROM zip_geo_view WHERE zip_code IN (${e})`),n={};a.forEach(e=>{e&&e.zip_code&&(n[String(e.zip_code)]=e)}),A=A.map(e=>e.zipCode&&n[e.zipCode]?{...e,latitude:n[e.zipCode].latitude?Number(n[e.zipCode].latitude):null,longitude:n[e.zipCode].longitude?Number(n[e.zipCode].longitude):null}:e)}}catch(e){console.warn("zip geo enrichment failed",e)}let N=j+x.length<C;return n.NextResponse.json({items:A,total:C,page:g,pageSize:m,hasMore:N})}catch(e){return console.error("Jobs API Error:",e),n.NextResponse.json({items:[],total:0,page:1,pageSize:20,hasMore:!1,error:e instanceof Error?e.message:"Internal Server Error"},{status:500})}}[o]=r.then?(await r)():r,e.s(["GET",()=>i]),a()}catch(e){a(e)}},!1),46285,e=>e.a(async(t,a)=>{try{var n=e.i(649),o=e.i(33955),r=e.i(7742),i=e.i(8607),l=e.i(26048),s=e.i(45664),d=e.i(62836),u=e.i(86656),c=e.i(56763),p=e.i(79655),h=e.i(63940),g=e.i(40093),m=e.i(67637),R=e.i(24592),b=e.i(47397),_=e.i(93695);e.i(79551);var f=e.i(22948),y=e.i(93131),v=t([y]);[y]=v.then?(await v)():v;let C=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/jobs/route",pathname:"/api/jobs",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/projobs/src/app/api/jobs/route.ts",nextConfigOutput:"",userland:y}),{workAsyncStorage:j,workUnitAsyncStorage:x,serverHooks:A}=C;function w(){return(0,r.patchFetch)({workAsyncStorage:j,workUnitAsyncStorage:x})}async function E(e,t,a){C.isDev&&(0,i.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/api/jobs/route";n=n.replace(/\/index$/,"")||"/";let r=await C.prepare(e,t,{srcPage:n,multiZoneDraftMode:!1});if(!r)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:y,params:v,nextConfig:w,parsedUrl:E,isDraftMode:j,prerenderManifest:x,routerServerContext:A,isOnDemandRevalidate:N,revalidateOnlyGenerated:S,resolvedPathname:P,clientReferenceManifest:T,serverActionsManifest:O}=r,I=(0,d.normalizeAppPath)(n),z=!!(x.dynamicRoutes[I]||x.routes[P]),U=async()=>((null==A?void 0:A.render404)?await A.render404(e,t,E,!1):t.end("This page could not be found"),null);if(z&&!j){let e=!!x.routes[P],t=x.dynamicRoutes[I];if(t&&!1===t.fallback&&!e){if(w.experimental.adapterPath)return await U();throw new _.NoFallbackError}}let k=null;!z||C.isDev||j||(k=P,k="/index"===k?"/":k);let H=!0===C.isDev||!z,M=z&&!H;O&&T&&(0,s.setManifestsSingleton)({page:n,clientReferenceManifest:T,serverActionsManifest:O});let q=e.method||"GET",D=(0,l.getTracer)(),$=D.getActiveScopeSpan(),F={params:v,prerenderManifest:x,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:H,incrementalCache:(0,i.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,a,n,o)=>C.onRequestError(e,t,n,o,A)},sharedContext:{buildId:y}},B=new u.NodeNextRequest(e),K=new u.NodeNextResponse(t),L=c.NextRequestAdapter.fromNodeNextRequest(B,(0,c.signalFromNodeResponse)(t));try{let r=async e=>C.handle(L,F).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=D.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let o=a.get("next.route");if(o){let t=`${q} ${o}`;e.setAttributes({"next.route":o,"http.route":o,"next.span_name":t}),e.updateName(t)}else e.updateName(`${q} ${n}`)}),s=!!(0,i.getRequestMeta)(e,"minimalMode"),d=async i=>{var l,d;let u=async({previousCacheEntry:o})=>{try{if(!s&&N&&S&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await r(i);e.fetchMetrics=F.renderOpts.fetchMetrics;let l=F.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let d=F.renderOpts.collectedTags;if(!z)return await (0,g.sendResponse)(B,K,n,F.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(n.headers);d&&(t[b.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let a=void 0!==F.renderOpts.collectedRevalidate&&!(F.renderOpts.collectedRevalidate>=b.INFINITE_CACHE)&&F.renderOpts.collectedRevalidate,o=void 0===F.renderOpts.collectedExpire||F.renderOpts.collectedExpire>=b.INFINITE_CACHE?void 0:F.renderOpts.collectedExpire;return{value:{kind:f.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:a,expire:o}}}}catch(t){throw(null==o?void 0:o.isStale)&&await C.onRequestError(e,t,{routerKind:"App Router",routePath:n,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:N})},!1,A),t}},c=await C.handleResponse({req:e,nextConfig:w,cacheKey:k,routeKind:o.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:x,isRoutePPREnabled:!1,isOnDemandRevalidate:N,revalidateOnlyGenerated:S,responseGenerator:u,waitUntil:a.waitUntil,isMinimalMode:s});if(!z)return null;if((null==c||null==(l=c.value)?void 0:l.kind)!==f.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(d=c.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",N?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),j&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,m.fromNodeOutgoingHttpHeaders)(c.value.headers);return s&&z||p.delete(b.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,R.getCacheControlHeader)(c.cacheControl)),await (0,g.sendResponse)(B,K,new Response(c.value.body,{headers:p,status:c.value.status||200})),null};$?await d($):await D.withPropagatedContext(e.headers,()=>D.trace(p.BaseServerSpan.handleRequest,{spanName:`${q} ${n}`,kind:l.SpanKind.SERVER,attributes:{"http.method":q,"http.target":e.url}},d))}catch(t){if(t instanceof _.NoFallbackError||await C.onRequestError(e,t,{routerKind:"App Router",routePath:I,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:N})},!1,A),z)throw t;return await (0,g.sendResponse)(B,K,new Response(null,{status:500})),null}}e.s(["handler",()=>E,"patchFetch",()=>w,"routeModule",()=>C,"serverHooks",()=>A,"workAsyncStorage",()=>j,"workUnitAsyncStorage",()=>x]),a()}catch(e){a(e)}},!1)];

//# sourceMappingURL=projobs_badfb320._.js.map